<!DOCTYPE html>
<html>

<head>
    <title>News</title>
    <link href="main.css" rel="stylesheet" type="text/css">
</head>


<body>
    <h1 id="Header">News</h1>
    <form>
        News Search: <input type="text" id="keyword" value="">
        <input id="searchButton" type="submit" value="Search"><br>
    </form>
    <div id="frontpage">
        <h2>Today's Headlines</h2>
    </div>

    <!--<button id="triviaButton">Click to Begin</button>-->

    <script src="http://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script src="script.js"></script>
    <script>
        $(document).ready(function() {
            $("#searchButton").click(function(e) {
                var value = $("#keyword").val();
                console.log(value);
                e.preventDefault();

                var searchurl = 'https://newsapi.org/v2/everything?q=' +
                    value +
                    '&apiKey=794f0bc98a2a4b5a86290d23ab18ed27';
                
                $.ajax({
                    url: searchurl,
                    dataType: "json",
                    success: function(response_json) {
                        var everything = "<h2>Search Results For: " + value + "</h2><br><ul>";
                        console.log(response_json);
                        var articles = response_json['articles'];
                        
                        console.log(articles);
                        $.each(articles, function(i, item) {
                            var title = articles[i]['title'];
                            var description = articles[i]['description'];
                            var arurl = articles[i]['url'];
                            var source = articles[i]['source']['name'];
                            everything += "<div class= \"news\">";
                            everything += "<img src=\"" + articles[i]['urlToImage'] + "\"class=\"newspic\">";
                            everything += "<h4 class=\"titles\">" + title + "</h4>";
                            everything += "<p class=\"descrip\">" + description + "</p>";
                            everything += "<button class=\"linktoarticle\" onclick=\"location.href=\'"+ arurl + "\'\" type=\"button\">Read more</button>";
                            everything += "<p class=\"source\"> Source: " + source + "</p>";
                            everything += "</div>"
                        })

                        everything += "</ul>";
                        $("#frontpage").html(everything);
                        e.preventDefault();
                    }
                });
            });
        });
        //     var req = new Request(url);
        //     fetch(req)
        //         .then(function(response) {
        //             console.log(response.json());
        //         })
        //          e.preventDefault();




        // $("#triviaButton").click(function(e){
        //     $(this).text('Click to Restart').toggleClass('clicked');
        //     var myurl = "https://opentdb.com/api.php?amount=10";
        //     var categorysearch = "https://opentdb.com/api_category.php";
        //     console.log(myurl);
        //     console.log(categorysearch);
        //       e.preventDefault();
        //       $.ajax ({
        //           url: categorysearch,
        //           dataType : "json",
        //           success : function(cat_json) {
        //               console.log(cat_json);
        //           }

        //       });
        //       $.ajax({
        //           url: myurl,
        //           dataType : "json",
        //           success : function(parsed_json) {
        //               console.log(parsed_json);
        //           }
        //       });

        //   });
    </script>
</body>

</html>
